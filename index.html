<html>

<head id="h1">
    <meta name="viewport" content="width=device-width">
</head>

<style id="s1">
    body {
        text-align: center;
        font-size: 35px;
        margin: 20px;
        background:white;
    }
    code# {
        margin: 5%;
        width: 10%;
        position: absolute;
        bottom:2%;
        right:1%;
    }
    button {
        font-size: 30px;
        border-radius: 10px;
        background: rgb(253, 81, 28);
        color: white;
        margin:20px;
    }
   
    #ta {
        width: 95%;
        display: none;
    }
    #tx {
        margin: 5%;
        width: 90%;
        font-size: 35px;
        height: 20%;
        background-color: rgb(14, 236, 118);
        display: none;
    }
   
  
    #todo{
        text-align: center;
        width: 100%;
    }
    .cin{
        width: 98%;
          text-align: right; 
        font-size: 18px;
        background-color: rgb(10, 248, 224);
        font-weight: bold;
    }
    #qi{
        position: absolute;
        top:1%;
        left:1%;
        color:white;
        background-color: red;;
        border-radius: 100px;
        opacity: .75;
        font-weight: bold;
        padding:15px;
   
    }
    #qt{
  
       width: 50%;
    }
    #tcl{
        width: 90%;
        height:55%;
      
    }
</style>
<div id="todo">
    <div id="dclip">
        <button id="bc" onclick="readClipb(true)">Copy Clipboard/header</button><br>
        <button id="bc" onclick="readClipb(false)">Copy Clipboard/no header</button><br><br>
        <select id="ops" oninput="readClipb(true, this.value)">Choose Option
 
            <option>Sort By...</option>
            <option>Date</option>
      <option>Mech</option>   
      <option>Part</option>
      <option>Job</option>
       </select><br><br>
  
        <textarea id="tcl"></textarea>
 
<div id="res">
 
    <textarea id="tx"></textarea>
</div>
 
</div>
<script src="html5-qrcode.min.js"></script>
<script>/*
        Date <input id="da" type="date" class="cin" value='today'><br></br>
*/</script>

<script>
  //  qi.style.width=qi.offsetHeight+"px";
 //   alert(qi.style.width+"\n\n"+qi.style.height)
     var linkp = 'https://jsonblob.com/api/d0317ef4-f48e-11eb-9b1d-755fd0c1d5cb';
     var linkc = 'https://jsonblob.com/api/0da2d184-f931-11eb-a6a9-8d2736c2c513'

function readClipb(op,by){
    GetJ(linkc,function(obj){
   
          var s="";
          var h='Qty'+ String.fromCharCode(9) +'Job'+ String.fromCharCode(9) +'Part No.'+ String.fromCharCode(9) +'Desc'+ String.fromCharCode(9) +'Mech'+ String.fromCharCode(9) +'Ret'+ String.fromCharCode(9) +'Date\n'
    
           a=obj.pulls;
       //    alert(by)
           if(by===undefined){
          for(var i=0;i<a.length;i++){
              var b=a[i];
              var fe=getFe(b.created);
          
                var pu="";
              si=1;
                 if(b.move==="return"){ pu="X";si=-1}
           
            
         s+=b.qty*si+ String.fromCharCode(9) +b.jobNo+ String.fromCharCode(9) +b.partN+ String.fromCharCode(9) +b.desc+ String.fromCharCode(9) +b.mechanic+ String.fromCharCode(9) +pu+ String.fromCharCode(9) +fe+"\n";

          }
        }
        else{
            if(by==="Date"){
                var arf=[];
               for(var i=0;i<a.length;i++)
                {
                       var v=Date.parse(a[i].created);
               
                   arf.push(v+"@"+JSON.stringify(a[i]));

                }
                arf=arf.sort();
              //  alert(arf);
                for(var i=0;i<arf.length;i++){
                    var o=arf[i].split("@")[1];
                   var b=JSON.parse(o);//alert(o)
               fe=getFe(b.created)
                 var pu="";
                   si=1;
                 if(b.move==="return"){ pu="X";si=-1} 
                    s+=b.qty*si+ String.fromCharCode(9) +b.jobNo+ String.fromCharCode(9) +b.partN+ String.fromCharCode(9) +b.desc+ String.fromCharCode(9) +b.mechanic+ String.fromCharCode(9) +pu+ String.fromCharCode(9) +fe+"\n";
           
                }
             

            }
            if(by==="Mech"){
  
                var arf=[];
               for(var i=0;i<a.length;i++)
                {
                    v=a[i].mechanic
                arf.push(v+"@"+JSON.stringify(a[i]));

                }
                arf=arf.sort(); 
                for(var i=0;i<arf.length;i++){
                    var o=arf[i].split("@")[1];
                   var b=JSON.parse(o);//alert(o)
               fe=getFe(b.created)
                 var pu="";
                   si=1;
                 if(b.move==="return"){ pu="X";si=-1} 
                    s+=b.qty*si+ String.fromCharCode(9) +b.jobNo+ String.fromCharCode(9) +b.partN+ String.fromCharCode(9) +b.desc+ String.fromCharCode(9) +b.mechanic+ String.fromCharCode(9) +pu+ String.fromCharCode(9) +fe+"\n";
           
                }
             




                }
       
if(by==="Part"){

    var arf=[];
               for(var i=0;i<a.length;i++)
                {
                    v=a[i].partN
                arf.push(v+"@"+JSON.stringify(a[i]));

                }
                arf=arf.sort(); 
                for(var i=0;i<arf.length;i++){
                    var o=arf[i].split("@")[1];
                   var b=JSON.parse(o);//alert(o)
               fe=getFe(b.created)
                 var pu="";
                   si=1;
                 if(b.move==="return"){ pu="X";si=-1} 
                    s+=b.qty*si+ String.fromCharCode(9) +b.jobNo+ String.fromCharCode(9) +b.partN+ String.fromCharCode(9) +b.desc+ String.fromCharCode(9) +b.mechanic+ String.fromCharCode(9) +pu+ String.fromCharCode(9) +fe+"\n";
           
                }
             


                
}
if(by==="Job"){
    var arf=[];
               for(var i=0;i<a.length;i++)
                {
                    v=a[i].jobNo
                arf.push(v+"@"+JSON.stringify(a[i]));

                }
                arf=arf.sort(); 
                for(var i=0;i<arf.length;i++){
                    var o=arf[i].split("@")[1];
                   var b=JSON.parse(o);//alert(o)
               fe=getFe(b.created)
                 var pu="";
                   si=1;
                 if(b.move==="return"){ pu="X";si=-1} 
                    s+=b.qty*si+ String.fromCharCode(9) +b.jobNo+ String.fromCharCode(9) +b.partN+ String.fromCharCode(9) +b.desc+ String.fromCharCode(9) +b.mechanic+ String.fromCharCode(9) +pu+ String.fromCharCode(9) +fe+"\n";
           
                }
             

                
}
 
var arf=[];
               for(var i=0;i<a.length;i++)
                {
                    v=a[i].mechanic
                arf.push(v+"@"+JSON.stringify(a[i]));

                }
                arf=arf.sort(); 
}
  
          if(op) tcl.value=h+s;
          else tcl.value=s;
/////////////////////////////

            var t = document.createElement("textarea");
            document.body.appendChild(t);

            t.innerHTML = tcl.value;
            t.select();
            document.execCommand("copy");

            //alert(so);
            document.body.removeChild(t)

 
    })
}

function getFe(fr){

   // var fe=fr.split("GMT")[0];
                var f=new Date()
              var v=Date.parse(fr);
              f.setTime(v)
            return f.getMonth()+"-"+f.getDate()+"-"+f.getFullYear();


}
    function loadDoc(url, callback) {
        var xhttp = new XMLHttpRequest();
        xhttp.open("GET", url, false);
        xhttp.send();
        callback(xhttp.responseText);

    }
    function sortBy(v){


    }
 
    function GetJ(url, callback) {

//var url  = "http://localhost:8080/api/v1/users";
var xhr = new XMLHttpRequest()
xhr.open('GET', url + '/1', true)
xhr.onload = function() {
    //         (xhr.responseText)
    var users = JSON.parse(xhr.responseText);
    //     var obb=decoding(users.prim);

    if (xhr.readyState == 4 && xhr.status == "200") {
        callback(users);
    } else {
        console.error(users);
    }
}
xhr.send(null);
}

// Update a user
function UpdateJ(url, ob, callback) {
//   var o={};
//   o.prim=encoding(ob);
 // alert(obj.pulls);
json = JSON.stringify(ob);
var xhr = new XMLHttpRequest();
xhr.open("PUT", url + '/12', true);
xhr.setRequestHeader('Content-type', 'application/json; charset=utf-8');
xhr.onload = function() {
    var users = JSON.parse(xhr.responseText);
    if (xhr.readyState == 4 && xhr.status == "200") {
        //  alert("Tu Forma ha sido Enviada");
        if (callback != undefined) callback(users);
    } else {
        (users);
    }
}
xhr.send(json);
}

</script>

</html>
